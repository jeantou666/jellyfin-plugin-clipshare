<!DOCTYPE html>
<html>
<head>
    <title>ClipShare Configuration</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 20px;
            background: #101010;
            color: #fff;
        }
        h1 { color: #00a4dc; }
        .section {
            background: #1a1a1a;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        code {
            background: #333;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
        }
        .bookmarklet {
            display: inline-block;
            background: #00a4dc;
            color: #fff;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            cursor: pointer;
        }
        .bookmarklet:hover {
            background: #0088bb;
        }
        .info {
            background: #2a2a00;
            border-left: 4px solid #ffc107;
            padding: 10px 15px;
            margin: 15px 0;
        }
        textarea {
            width: 100%;
            height: 100px;
            background: #222;
            color: #fff;
            border: 1px solid #444;
            border-radius: 4px;
            padding: 10px;
            font-family: monospace;
        }
        button {
            background: #00a4dc;
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0088bb;
        }
    </style>
</head>
<body>
    <h1>‚úÇÔ∏è ClipShare Configuration</h1>

    <div class="section">
        <h2>üì° Script URL</h2>
        <p>The ClipShare script is available at:</p>
        <code id="scriptUrl"></code>
    </div>

    <div class="section">
        <h2>üöÄ Quick Setup</h2>

        <h3>Option 1: Browser Console (Temporary)</h3>
        <p>Open the browser console (F12) on any Jellyfin page and paste:</p>
        <textarea id="consoleCode" readonly></textarea>
        <button onclick="copyConsoleCode()">üìã Copy</button>

        <h3>Option 2: Bookmarklet</h3>
        <p>Drag this button to your bookmarks bar:</p>
        <a class="bookmarklet" id="bookmarklet">‚úÇÔ∏è ClipShare</a>

        <h3>Option 3: Userscript (Recommended)</h3>
        <p>Install <a href="https://www.tampermonkey.net/" target="_blank" style="color:#00a4dc">Tampermonkey</a> and click below:</p>
        <button onclick="installUserscript()">üì¶ Install Userscript</button>
    </div>

    <div class="section">
        <h2>‚öôÔ∏è Settings</h2>
        <p>Default expiration (hours): <input type="number" id="expireHours" value="72" style="width: 80px; padding: 5px; background: #222; color: #fff; border: 1px solid #444; border-radius: 4px;"></p>
        <button onclick="saveSettings()">üíæ Save</button>
    </div>

    <div class="info">
        <strong>üí° Tip:</strong> The ClipShare button will appear in the video player controls.
        Use <code>C</code> keyboard shortcut to quickly create clips.
    </div>

    <script>
        // Get the base URL
        const baseUrl = window.location.origin;
        const scriptUrl = baseUrl + '/ClipShare/script';

        document.getElementById('scriptUrl').textContent = scriptUrl;

        // Console code
        const consoleCode = `// Load ClipShare
(function(){var s=document.createElement('script');s.src='${scriptUrl}';document.head.appendChild(s);})();`;
        document.getElementById('consoleCode').value = consoleCode;

        // Bookmarklet
        const bookmarkletCode = `javascript:(function(){var s=document.createElement('script');s.src='${scriptUrl}';document.head.appendChild(s);})();`;
        document.getElementById('bookmarklet').href = bookmarkletCode;

        function copyConsoleCode() {
            navigator.clipboard.writeText(consoleCode);
            alert('Copied to clipboard!');
        }

        function installUserscript() {
            const userscript = `// ==UserScript==
// @name         ClipShare for Jellyfin
// @namespace    http://tampermonkey.net/
// @version      1.0
// @description  Create clips from Jellyfin video player
// @match        ${baseUrl}/*
// @grant        none
// ==/UserScript==

(function() {
    'use strict';
    var s = document.createElement('script');
    s.src = '${scriptUrl}';
    document.head.appendChild(s);
})();`;

            const blob = new Blob([userscript], { type: 'text/javascript' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'clipshare.user.js';
            a.click();
            URL.revokeObjectURL(url);
        }

        function saveSettings() {
            const hours = document.getElementById('expireHours').value;
            localStorage.setItem('clipshare_expireHours', hours);
            alert('Settings saved!');
        }

        // Load saved settings
        const savedHours = localStorage.getItem('clipshare_expireHours');
        if (savedHours) {
            document.getElementById('expireHours').value = savedHours;
        }
    </script>
</body>
</html>
